{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kemoo\\\\OneDrive - University of Pretoria\\\\Desktop\\\\Proj\\\\foodsave-hub\\\\client\\\\src\\\\notifications\\\\Notification.js\";\nimport React, { Component } from 'react';\nimport './Notifications.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass Notification extends Component {\n  constructor(props) {\n    super(props);\n    this.fetchNotifications = async () => {\n      try {\n        const response = await fetch('http://localhost:5000/api/notifications');\n        if (!response.ok) throw new Error('Failed to fetch notifications');\n        const data = await response.json();\n\n        // Map backend data to frontend format\n        const notifications = data.map(item => {\n          const {\n            expiryStatus,\n            status\n          } = this.getExpiryStatus(item.expirydate);\n          return {\n            id: item.fooditemid,\n            name: `${item.quantity} ${item.name}`,\n            expiryStatus,\n            status\n          };\n        });\n        this.setState({\n          notifications,\n          loading: false,\n          error: null\n        });\n      } catch (error) {\n        console.error('Error fetching notifications:', error);\n        this.setState({\n          error: error.message,\n          loading: false\n        });\n      }\n    };\n    this.state = {\n      notifications: [],\n      loading: true,\n      error: null\n    };\n  }\n  componentDidMount() {\n    this.fetchNotifications();\n    // Auto-refresh every 10 seconds\n    this.interval = setInterval(this.fetchNotifications, 10000);\n  }\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  // Calculate expiry status based on expirydate\n  getExpiryStatus(expiryDate) {\n    const today = new Date();\n    const expDate = new Date(expiryDate);\n    if (isNaN(expDate)) return {\n      expiryStatus: 'Invalid date',\n      status: 'warning'\n    };\n    const diffTime = expDate - today;\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    if (diffDays < 0) return {\n      expiryStatus: `Expired ${Math.abs(diffDays)} day(s) ago`,\n      status: 'expired'\n    };\n    if (diffDays <= 3) return {\n      expiryStatus: `Expires in ${diffDays} day(s)`,\n      status: 'warning'\n    };\n    return {\n      expiryStatus: `Expires in ${diffDays} day(s)`,\n      status: 'good'\n    };\n  }\n  render() {\n    const {\n      notifications,\n      loading,\n      error\n    } = this.state;\n    if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading notifications...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 25\n    }, this);\n    if (error) return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Error: \", error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 23\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notification-page\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"notification-title\",\n        children: \"Notifications\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), notifications.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No notifications available.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this) : notifications.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"notification-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"notification-title-text\",\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"notification-meta\",\n            children: item.expiryStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: `notification-status ${item.status === 'expired' ? 'status-expired' : item.status === 'warning' ? 'status-warning' : 'status-good'}`,\n          children: item.status\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 15\n        }, this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this);\n  }\n}\nexport default Notification;","map":{"version":3,"names":["React","Component","jsxDEV","_jsxDEV","Notification","constructor","props","fetchNotifications","response","fetch","ok","Error","data","json","notifications","map","item","expiryStatus","status","getExpiryStatus","expirydate","id","fooditemid","name","quantity","setState","loading","error","console","message","state","componentDidMount","interval","setInterval","componentWillUnmount","clearInterval","expiryDate","today","Date","expDate","isNaN","diffTime","diffDays","Math","ceil","abs","render","children","fileName","_jsxFileName","lineNumber","columnNumber","className","length"],"sources":["C:/Users/kemoo/OneDrive - University of Pretoria/Desktop/Proj/foodsave-hub/client/src/notifications/Notification.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport './Notifications.css';\r\n\r\nclass Notification extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      notifications: [],\r\n      loading: true,\r\n      error: null,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchNotifications();\r\n    // Auto-refresh every 10 seconds\r\n    this.interval = setInterval(this.fetchNotifications, 10000);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    clearInterval(this.interval);\r\n  }\r\n\r\n  // Calculate expiry status based on expirydate\r\n  getExpiryStatus(expiryDate) {\r\n    const today = new Date();\r\n    const expDate = new Date(expiryDate);\r\n\r\n    if (isNaN(expDate)) return { expiryStatus: 'Invalid date', status: 'warning' };\r\n\r\n    const diffTime = expDate - today;\r\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n\r\n    if (diffDays < 0)\r\n      return { expiryStatus: `Expired ${Math.abs(diffDays)} day(s) ago`, status: 'expired' };\r\n    if (diffDays <= 3)\r\n      return { expiryStatus: `Expires in ${diffDays} day(s)`, status: 'warning' };\r\n    return { expiryStatus: `Expires in ${diffDays} day(s)`, status: 'good' };\r\n  }\r\n\r\n  fetchNotifications = async () => {\r\n    try {\r\n      const response = await fetch('http://localhost:5000/api/notifications');\r\n      if (!response.ok) throw new Error('Failed to fetch notifications');\r\n\r\n      const data = await response.json();\r\n\r\n      // Map backend data to frontend format\r\n      const notifications = data.map((item) => {\r\n        const { expiryStatus, status } = this.getExpiryStatus(item.expirydate);\r\n        return {\r\n          id: item.fooditemid,\r\n          name: `${item.quantity} ${item.name}`,\r\n          expiryStatus,\r\n          status,\r\n        };\r\n      });\r\n\r\n      this.setState({ notifications, loading: false, error: null });\r\n    } catch (error) {\r\n      console.error('Error fetching notifications:', error);\r\n      this.setState({ error: error.message, loading: false });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { notifications, loading, error } = this.state;\r\n\r\n    if (loading) return <p>Loading notifications...</p>;\r\n    if (error) return <p>Error: {error}</p>;\r\n\r\n    return (\r\n      <div className=\"notification-page\">\r\n        <h2 className=\"notification-title\">Notifications</h2>\r\n\r\n        {notifications.length === 0 ? (\r\n          <p>No notifications available.</p>\r\n        ) : (\r\n          notifications.map((item) => (\r\n            <div key={item.id} className=\"notification-card\">\r\n              <div className=\"notification-info\">\r\n                <p className=\"notification-title-text\">{item.name}</p>\r\n                <p className=\"notification-meta\">{item.expiryStatus}</p>\r\n              </div>\r\n              <span\r\n                className={`notification-status ${\r\n                  item.status === 'expired'\r\n                    ? 'status-expired'\r\n                    : item.status === 'warning'\r\n                    ? 'status-warning'\r\n                    : 'status-good'\r\n                }`}\r\n              >\r\n                {item.status}\r\n              </span>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Notification;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}